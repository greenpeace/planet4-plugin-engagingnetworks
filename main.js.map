{"version":3,"sources":["partials/blocks_wide.js","partials/enform_submit.js"],"names":["$","document","ready","$wideblocks","$container","eq","force_wide_blocks","vw","width","each","this","innerWidth","margin","attr","css","length","window","on","validateForm","form","formIsValid","elements","element","removeClass","errorDiv","next","hasClass","remove","removeErrorMessage","formValue","val","test","String","toLowerCase","addClass","$invalidDiv","html","data","insertAfter","addErrorMessage","submit","e","preventDefault","off","$content","url","en_vars","ajaxurl","values","i","field","name","indexOf","id","split","serializeArray","value","ajax","type","action","_wpnonce","en_page_id","done","response","redirectURL","location","fail","console","log"],"mappings":"AACAA,EAAAC,UAAAC,MAAA,WACA,aAEA,IAAAC,EAAAH,EAAA,eACAI,EAAAJ,EAAA,oCAAAK,GAAA,GAEA,SAAAC,IACA,IAAAC,EAAAH,EAAAI,QACAL,EAAAM,KAAA,WACA,IAAAD,EAAAR,EAAAU,MAAAC,aAEAC,GAAAL,EAAAC,GAAA,EAEA,QAAAR,EAAA,QAAAa,KAAA,QACAb,EAAAU,MAAAI,IAAA,cAAA,QACAd,EAAAU,MAAAI,IAAA,eAAAF,EAAA,OAEAZ,EAAAU,MAAAI,IAAA,cAAAF,EAAA,QAKAT,EAAAY,OAAA,GAAAX,EAAAW,OAAA,GACAT,IACAN,EAAAgB,QAAAC,GAAA,SAAAX,KAEAN,EAAA,eAAAa,KAAA,QAAA,qFACAb,EAAA,UAAAa,KAAA,QAAA,cC3BAb,EAAAC,UAAAC,MAAA,WACA,aAoCA,SAAAgB,EAAAC,GACA,IAAAC,GAAA,EAeA,OAbApB,EAAAmB,EAAAE,UAAAZ,KAAA,YAXA,SAAAa,GACAtB,EAAAsB,GAAAC,YAAA,cACA,IAAAC,EAAAxB,EAAAsB,GAAAG,OACAD,EAAAT,QAAAS,EAAAE,SAAA,qBACA1B,EAAAwB,GAAAG,SAQAC,CAAAlB,MACA,IAAAmB,EAAA7B,EAAAU,MAAAoB,OAGA9B,EAAAU,MAAAG,KAAA,cAAAgB,GACA,UAAA7B,EAAAU,MAAAG,KAAA,UAjCA,wJACAkB,KAAAC,OAgCAH,GAhCAI,mBAOA,SAAAX,GACAtB,EAAAsB,GAAAY,SAAA,cACA,IAAAC,EAAAnC,EAAA,SACAmC,EAAAD,SAAA,oBACAC,EAAAC,KAAApC,EAAAsB,GAAAe,KAAA,iBACAF,EAAAG,YAAAhB,GAsBAiB,CAAA7B,MACAU,GAAA,KAIAA,EAGApB,EAAA,cAAAwC,OAAA,SAAAC,GArDA,IAAAtB,EAsDAsB,EAAAC,iBAtDAvB,EAyDAT,KAxDAV,EAAAmB,EAAAE,UAAAZ,KAAA,WACAT,EAAAU,MAAAiC,IAAA,gBAAA1B,GAAA,eAAA,WACAC,EAAAC,OAwDA,MAAAyB,EAAA5C,EAAA,WACA,GAAAkB,EAAAR,MAAA,CACA,MAAAmC,EAAAC,QAAAC,QACA,IAAAC,EAAA,GAGAhD,EAAA,uCAAA8B,IAAA,KACA9B,EAAAS,KAAAT,EAAA,+CAAA,SAAAiD,EAAAC,GACA,GAAAA,EAAAC,KAAAC,QAAA,yBAAA,EAAA,CACA,IAAAC,EAAAH,EAAAC,KAAAG,MAAA,KAAA,GACAN,EAAA,sBAAAK,GAAA,OAIArD,EAAAS,KAAAT,EAAA,cAAAuD,iBAAA,SAAAN,EAAAC,GACA,GAAAA,EAAAC,KAAAC,QAAA,yBAAA,EAAA,CACA,IAAAC,EAAAH,EAAAC,KAAAG,MAAA,KAAA,GACAN,EAAA,sBAAAK,GAAAH,EAAAM,WAEAR,EAAAE,EAAAC,MAAAD,EAAAM,QAIAxD,EAAAyD,KAAA,CACAZ,IAAAA,EACAa,KAAA,OACArB,KAAA,CACAsB,OAAA,gBACAC,SAAA5D,EAAA,YAAAA,EAAAU,OAAAoB,MACA+B,WAAA7D,EAAA,0BAAA8B,MACAkB,OAAAA,KAEAc,KAAA,SAAAC,GACA,IAAAC,EAAApB,EAAAP,KAAA,gBA7EA,uqCAAAN,KA+EAiC,GACAhD,OAAAiD,SAAAD,EAEApB,EAAAR,KAAA2B,KAEAG,KAAA,SAAAH,GACAI,QAAAC,IAAAL","file":"main.js","sourcesContent":["// Force wide blocks outside the container\n$(document).ready(function() {\n  'use strict';\n\n  var $wideblocks = $('.block-wide');\n  var $container = $('div.page-template, div.container').eq(0);\n\n  function force_wide_blocks() {\n    var vw = $container.width();\n    $wideblocks.each(function() {\n      var width = $(this).innerWidth();\n\n      var margin = ((vw - width) / 2);\n\n      if ($('html').attr('dir') === 'rtl') {\n        $(this).css('margin-left', 'auto');\n        $(this).css('margin-right', margin + 'px');\n      } else {\n        $(this).css('margin-left', margin + 'px');\n      }\n    });\n  }\n\n  if ($wideblocks.length > 0 && $container.length > 0) {\n    force_wide_blocks();\n    $(window).on('resize', force_wide_blocks);\n  } else {\n    $('.block-wide').attr('style','margin: 0px !important;padding-left: 0px !important;padding-right: 0px !important');\n    $('iframe').attr('style','left: 0');\n  }\n});\n  ","/* global en_vars */\n$(document).ready(function () {\n  'use strict';\n\n  function addChangeListeners(form) {\n    $(form.elements).each(function() {\n      $(this).off('change keyup').on('change keyup', function() {\n        validateForm(form);\n      });\n    });\n  }\n\n  function validateEmail(email) {\n    // Reference: https://stackoverflow.com/questions/46155/how-to-validate-an-email-address-in-javascript\n    var re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n  }\n\n  function validateUrl(url) {\n    return /^(https?|s?ftp):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i.test(url);  //eslint-disable-line no-useless-escape\n  }\n\n  function addErrorMessage(element) {\n    $(element).addClass('is-invalid');\n    var $invalidDiv = $('<div>');\n    $invalidDiv.addClass('invalid-feedback');\n    $invalidDiv.html($(element).data('errormessage'));\n    $invalidDiv.insertAfter(element);\n  }\n\n  function removeErrorMessage(element) {\n    $(element).removeClass('is-invalid');\n    var errorDiv = $(element).next();\n    if (errorDiv.length && errorDiv.hasClass('invalid-feedback')) {\n      $(errorDiv).remove();\n    }\n  }\n\n  function validateForm(form) {\n    var formIsValid = true;\n\n    $(form.elements).each(function() {\n      removeErrorMessage(this);\n      var formValue = $(this).val();\n\n      if (\n        $(this).attr('required') && ! formValue ||\n        'email' === $(this).attr('type') && ! validateEmail( formValue )\n      ) {\n        addErrorMessage(this);\n        formIsValid = false;\n      }\n    });\n\n    return formIsValid;\n  }\n\n  $('#p4en_form').submit(function(e) {\n    e.preventDefault();\n\n    // Don't bug users with validation before the first submit\n    addChangeListeners(this);\n\n    const $content = $('#enform');\n    if (validateForm(this)) {\n      const url = en_vars.ajaxurl;\n      let values = {};\n\n      // Prepare the questions/optins values the way that ENS api expects them.\n      $('.en__field__input--checkbox:checked').val('Y');\n      $.each($('.en__field__input--checkbox:not(\":checked\")'), function(i, field) {\n        if ( field.name.indexOf( 'supporter.questions.' ) >= 0 ) {\n          let id = field.name.split('.')[2];\n          values['supporter.question.' + id] = 'N';\n        }\n      });\n\n      $.each($('#p4en_form').serializeArray(), function(i, field) {\n        if ( field.name.indexOf( 'supporter.questions.' ) >= 0 ) {\n          let id = field.name.split('.')[2];\n          values['supporter.question.' + id] = field.value;\n        } else {\n          values[field.name] = field.value;\n        }\n      });\n\n      $.ajax({\n        url: url,\n        type: 'POST',\n        data: {\n          action:     'handle_submit',\n          '_wpnonce': $( '#_wpnonce', $(this) ).val(),\n          'en_page_id': $('input[name=en_page_id]').val(),\n          values: values,\n        },\n      }).done(function ( response ) {\n        var redirectURL = $content.data('redirect-url');\n\n        if ( validateUrl( redirectURL ) ) {\n          window.location = redirectURL;\n        } else {\n          $content.html( response );\n        }\n      }).fail(function ( response ) {\n        console.log(response); //eslint-disable-line no-console\n      });\n    }\n  });\n});\n"]}